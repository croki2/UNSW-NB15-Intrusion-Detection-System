## ğŸš€ UNSW-NB15 Intrusion Detection System (IDS)

A complete Machine Learningâ€“based Intrusion Detection System built using the UNSW-NB15 cybersecurity dataset.
The project performs data preprocessing, model training, evaluation, and prepares the system for real-time intrusion detection.

## ğŸ“Œ 1. Project Overview

This project implements two ML models (Random Forest & XGBoost) to classify network traffic as normal or malicious, based on the UNSW-NB15 dataset (~2.5M rows).

Key capabilities:

Load & merge the full UNSW-NB15 dataset (4 CSV parts)

Clean and preprocess all features

Encode categorical columns (proto, state, service, attack_cat)

Train two ML models

Evaluate accuracy, precision, recall, F1-score

Generate confusion matrices & feature importance plots

Export trained models for real-time inference

## ğŸ“‚ 2. Project Structure
```
UNSW-NB15-Intrusion-Detection-System/
â”‚
â”œâ”€â”€ src/                     # Scripts (data preprocessing, ML training)
â”œâ”€â”€ data/                    # (ignored) dataset placeholder
â”œâ”€â”€ models/                  # (ignored) saved ML models
â”œâ”€â”€ images/                  # Confusion matrices & plots
â”œâ”€â”€ results/                 # Evaluation outputs
â”‚
â”œâ”€â”€ ids_model.py             # Full training pipeline (RF + XGBoost)
â”œâ”€â”€ predict_packet.py        # Load model and classify new flows
â”œâ”€â”€ feature_importance.png   # Top features visualization
â”œâ”€â”€ rf_confusion_matrix.png
â”œâ”€â”€ xgb_confusion_matrix.png
â”‚
â””â”€â”€ .gitignore               # Excludes large files from GitHub
```

## ğŸ§¹ 3. Data Preprocessing Pipeline

The ids_model.py script performs:

## âœ”ï¸ Step 1 â€” Load UNSW-NB15 dataset

Loads the 4 CSV parts and merges them into a single dataframe.

## âœ”ï¸ Step 2 â€” Clean data

Handles non-numeric columns

Removes missing labels

Converts numerical columns safely (errors='coerce')

## âœ”ï¸ Step 3 â€” Encode categorical features

Encodes:

proto

state

service

attack_cat

## âœ”ï¸ Step 4 â€” Feature preparation

Removes IP fields (cannot be used for training)

Ensures all features are numeric

## âœ”ï¸ Step 5 â€” Stratified split

Preserves attack distribution between train and test sets.

## ğŸ“¦ 4. Trained Models

Models are saved inside the models/ directory:
```
models/
â”œâ”€â”€ rf_ids_model.pkl
â””â”€â”€ xgb_ids_model.pkl
```

You can load them using predict_packet.py.

## ğŸ¤– 5. Machine Learning Models

Two models are trained and compared:

## 1ï¸âƒ£ Random Forest

200 trees

Robust for tabular data

Fast training, good generalization

## 2ï¸âƒ£ XGBoost

Optimized gradient boosting

Excellent performance on large datasets

Handles unbalanced classes well

Both models achieved > 99.9% accuracy, with high precision & recall.

## ğŸ“Š 6. Evaluation Outputs

Each model generates:


## Classification report (accuracy, precision, recall, F1)
<img width="772" height="276" alt="image" src="https://github.com/user-attachments/assets/f08acba5-3268-48ed-9303-00b6d0cefe8a" />

## Confusion matrix 
<img width="700" height="500" alt="rf_confusion_matrix" src="https://github.com/user-attachments/assets/3174b9a0-fc6d-4b55-a406-71aecf9ecf84" />

## Feature importance plot 
<img width="1000" height="600" alt="feature_importance" src="https://github.com/user-attachments/assets/c83ba9e3-4d53-453f-b6f0-c0f8cc771f7a" />


## Below are the evaluation results of the XGBoost Classifier trained on the UNSW-NB15 dataset.

## âœ”ï¸ Classification Report

<img width="762" height="344" alt="image" src="https://github.com/user-attachments/assets/1f8456b1-4294-4d1e-9796-3db5abbf860c" />


## âœ”ï¸ Confusion Matrix

The confusion matrix generated by the model is available here:

<img width="700" height="500" alt="xgb_confusion_matrix" src="https://github.com/user-attachments/assets/113528bb-4dc3-4ab1-b850-be812b114249" />


## âœ”ï¸ Notes

XGBoost showed excellent performance in detecting malicious flows even in minority classes.

Performs better than Random Forest on complex features due to boosted tree optimization.

Works efficiently with large datasets.


## ğŸ”® 7. Future Improvements

Planned additions:

Real-time packet sniffing using Scapy

Deep learning models (LSTM / 1D-CNN)

FastAPI/Flask REST API for live predictions

Docker container for deployment

Streamlit dashboard for visualization

## ğŸ§‘â€ğŸ’» 8. How to Run the Project
## âœ”ï¸ Step 1 â€” Download the dataset

Get UNSW-NB15 from:
https://research.unsw.edu.au/projects/unsw-nb15-dataset

Place the 4 CSV files into:

data/

## âœ”ï¸ Step 2 â€” Train the models
```
python ids_model.py
```
## âœ”ï¸ Step 3 â€” Predict a new packet/flow
```
python predict_packet.py
```
## ğŸ“« 9. Contact

If you are a professor or researcher working on ML or cybersecurity, feel free to reach out:

El Mehdi El Afghani
ğŸ“§ elafghani.mhd@gmail.com

ğŸ”— GitHub: https://github.com/croki2
